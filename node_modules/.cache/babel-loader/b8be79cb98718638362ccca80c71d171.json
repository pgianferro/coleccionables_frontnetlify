{"ast":null,"code":"var _jsxFileName = \"/Users/pablogianferro/Downloads/CURSO WEB FULL STACK/Proyecto Integrador/REPOAWS/coleccionables/frontend/src/components/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst crypto = require(\"crypto-js\");\n\nconst BACKEND_ADDRESS = 'http://localhost:3001';\n\nfunction Login() {\n  _s();\n\n  const privateSeed = 'DigitalHouse';\n  const username = useRef();\n  const password = useRef();\n  const [loginError, setLoginError] = useState(false);\n  const [redirect, setRedirect] = useState(false);\n\n  const loginFetch = e => {\n    e.preventDefault();\n    setLoginError(false);\n    const cryptedPassword = crypto.AES.encrypt(password.current.value, privateSeed).toString();\n    /* \t\tconst hashPassword = crypto.AES.decrypt(cryptedPassword, privateSeed);\n    \t\tconst decryptedPassword = hashPassword.toString(crypto.enc.Utf8); */\n\n    const data = {\n      username: username.current.value,\n      password: cryptedPassword\n    };\n\n    const registerLogin = data => {\n      if (data.access === 'Granted') {\n        sessionStorage.setItem('usuario', JSON.stringify(data.user));\n        setRedirect(true);\n      } else {\n        setLoginError(true);\n        sessionStorage.removeItem('usuario');\n      }\n    };\n\n    fetch(`${BACKEND_ADDRESS}/api/users/auth`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    }).then(response => response.json()).then(data => registerLogin(data));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid\",\n    children: [/*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row my-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 col-md-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"\",\n              children: \"Nombre de usuario o email:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 10\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              ref: username,\n              className: \"form-control\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 61,\n              columnNumber: 10\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"\",\n              children: \"Contrase\\xF1a:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 62,\n              columnNumber: 10\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"password\",\n              ref: password,\n              className: \"form-control\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 63,\n              columnNumber: 10\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 59,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-info\",\n            onClick: loginFetch,\n            children: \"Login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 10\n          }, this), redirect ? /*#__PURE__*/_jsxDEV(Redirect, {\n            to: \"/\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 22\n          }, this) : '']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 6\n      }, this)\n    }, void 0, false), loginError ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-danger text-center my-4 fs-2\",\n      children: \"Usuario o contrase\\xF1a incorrecta\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 18\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 3\n  }, this);\n}\n\n_s(Login, \"FxsvmcLFofKzh1xf+f/vWG1Ax1A=\");\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Redirect","crypto","require","BACKEND_ADDRESS","Login","privateSeed","username","password","loginError","setLoginError","redirect","setRedirect","loginFetch","e","preventDefault","cryptedPassword","AES","encrypt","current","value","toString","data","registerLogin","access","sessionStorage","setItem","JSON","stringify","user","removeItem","fetch","method","headers","body","then","response","json"],"sources":["/Users/pablogianferro/Downloads/CURSO WEB FULL STACK/Proyecto Integrador/REPOAWS/coleccionables/frontend/src/components/Login.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { Redirect } from 'react-router-dom';\nconst crypto = require(\"crypto-js\");\nconst BACKEND_ADDRESS = 'http://localhost:3001';\n\nfunction Login(){\n\tconst privateSeed = 'DigitalHouse';\n\n\tconst username = useRef();\n\tconst password = useRef();\n\tconst [loginError, setLoginError] = useState(false);\n\tconst [redirect, setRedirect] = useState(false);\n\n\tconst loginFetch = (e) => {\n\t\te.preventDefault();\n\t\tsetLoginError(false);\n\n\t\tconst cryptedPassword = crypto.AES.encrypt(password.current.value, privateSeed).toString();\n\n/* \t\tconst hashPassword = crypto.AES.decrypt(cryptedPassword, privateSeed);\n\t\tconst decryptedPassword = hashPassword.toString(crypto.enc.Utf8); */\n\n\t\tconst data = {\n\t\t\tusername: username.current.value,\n\t\t\tpassword: cryptedPassword\n\t\t}\n\n\t\tconst registerLogin = data => {\n\t\t\tif (data.access === 'Granted') {\n\t\t\t\tsessionStorage.setItem('usuario', JSON.stringify(data.user));\n\t\t\t\tsetRedirect(true);\n\n\t\t\t} else {\n\t\t\t\tsetLoginError(true);\n\t\t\t\tsessionStorage.removeItem('usuario');\n\t\t\t\t\n\t\t\t}\n\t\t}\n\n\t\tfetch(`${BACKEND_ADDRESS}/api/users/auth`, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tbody: JSON.stringify(data),\n\t\t})\n\t\t\t.then(response => response.json())\n\t\t\t.then(data => registerLogin(data));\n\n\t}\n\n\treturn(\n\t\t<div className=\"container-fluid\">\n\t\t\t\t<>\n\t\t\t\t\t<div className=\"row my-4\">\n\t\t\t\t\t\t<div className=\"col-12 col-md-6\">\n\t\t\t\t\t\t\t{/* Login Form */}\n\t\t\t\t\t\t\t{/* <form method=\"POST\" onSubmit={loginFetch}> */}\n\t\t\t\t\t\t\t\t<div className=\"form-group\">\n\t\t\t\t\t\t\t\t\t<label htmlFor=\"\">Nombre de usuario o email:</label>\n\t\t\t\t\t\t\t\t\t<input type=\"text\" ref={username} className=\"form-control\" />\n\t\t\t\t\t\t\t\t\t<label htmlFor=\"\">Contraseña:</label>\n\t\t\t\t\t\t\t\t\t<input type=\"password\" ref={password} className=\"form-control\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<button className=\"btn btn-info\" onClick={loginFetch}>Login</button>\n\t\t\t\t\t\t\t\t\t{redirect ? <Redirect to=\"/\"/> : ''}\n\t\t\t\t\t\t\t{/* </form> */}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t{loginError ? <div className=\"alert alert-danger text-center my-4 fs-2\">Usuario o contraseña incorrecta</div> : <></>}\n\t\t\t\n\t\t</div>\n\t)\n}\n\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}